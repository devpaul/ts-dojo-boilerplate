{"version":3,"file":"load.js","sourceRoot":"","sources":["../../src/load.ts"],"names":[],"mappings":";;;;;;;;;IACA,uBAAmB,UAAU,CAAC,CAAA;IAU9B,4CAA4C;IAC5C,IAAM,OAAO,GAAa,SAAS,IAAI,gBAAM;UAC1C,gBAAM,CAAC,OAAO;UACd,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,CAAC,QAAQ,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI;cAChE,OAAO,CAAC,4BAA4B,CAAE,CAAC,OAAO;cAC9C,OAAO,CAAC,mBAAmB,CAAE,CAAC,OAAO,CAAC;IAajD,IAAM,IAAI,GAAS,CAAC;QACnB,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,QAAQ,IAAI,OAAO,MAAM,CAAC,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC;YACtE,MAAM,CAAC,UAAU,iBAAsB;gBAAE,mBAAsB;qBAAtB,WAAsB,CAAtB,sBAAsB,CAAtB,IAAsB;oBAAtB,kCAAsB;;gBAC9D,EAAE,CAAC,CAAC,OAAO,iBAAiB,KAAK,QAAQ,CAAC,CAAC,CAAC;oBAC3C,SAAS,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;oBACrC,iBAAiB,GAAG,OAAO,CAAC;gBAC7B,CAAC;gBACD,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;oBAC3C,IAAI,CAAC;wBACJ,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,QAAQ;4BACvC,MAAM,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;wBACpC,CAAC,CAAC,CAAC,CAAC;oBACL,CACA;oBAAA,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;wBACd,MAAM,CAAC,KAAK,CAAC,CAAC;oBACf,CAAC;gBACF,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC;QACH,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;YACrD,MAAM,CAAC,UAAU,iBAAsB;gBAAE,mBAAsB;qBAAtB,WAAsB,CAAtB,sBAAsB,CAAtB,IAAsB;oBAAtB,kCAAsB;;gBAC9D,EAAE,CAAC,CAAC,OAAO,iBAAiB,KAAK,QAAQ,CAAC,CAAC,CAAC;oBAC3C,SAAS,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;oBACrC,iBAAiB,GAAG,OAAO,CAAC;gBAC7B,CAAC;gBACD,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO;oBACnC,gFAAgF;oBAChF,iBAAiB,CAAC,SAAS,EAAE;wBAAU,iBAAiB;6BAAjB,WAAiB,CAAjB,sBAAiB,CAAjB,IAAiB;4BAAjB,gCAAiB;;wBACvD,OAAO,CAAC,OAAO,CAAC,CAAC;oBAClB,CAAC,CAAC,CAAC;gBACJ,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC;QACH,CAAC;QACD,IAAI,CAAC,CAAC;YACL,MAAM,CAAC;gBACN,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC;YACpD,CAAC,CAAC;QACH,CAAC;IACF,CAAC,CAAC,EAAE,CAAC;IACL;sBAAe,IAAI,CAAC","sourcesContent":["import P from 'dojo-shim/Promise';\nimport global from './global';\nimport { Require } from './loader';\n\ndeclare const require: Require;\n\ndeclare const define: {\n\t(...args: any[]): any;\n\tamd: any;\n};\n\n/* tslint:disable-next-line:variable-name */\nconst Promise: typeof P = 'Promise' in global\n\t? global.Promise\n\t: typeof process === 'object' && process.versions && process.versions.node\n\t\t? (<any> require('dojo-shim/dist/umd/Promise')).default\n\t\t: (<any> require('dojo-shim/Promise')).default;\n\nexport interface NodeRequire {\n\t(moduleId: string): any;\n}\n\nexport type Require = Require | NodeRequire;\n\nexport interface Load {\n\t(require: Require, ...moduleIds: string[]): P<any[]>;\n\t(...moduleIds: string[]): P<any[]>;\n}\n\nconst load: Load = (function (): Load {\n\tif (typeof module === 'object' && typeof module.exports === 'object') {\n\t\treturn function (contextualRequire: any, ...moduleIds: string[]): P<any[]> {\n\t\t\tif (typeof contextualRequire === 'string') {\n\t\t\t\tmoduleIds.unshift(contextualRequire);\n\t\t\t\tcontextualRequire = require;\n\t\t\t}\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\ttry {\n\t\t\t\t\tresolve(moduleIds.map(function (moduleId): any {\n\t\t\t\t\t\treturn contextualRequire(moduleId);\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tcatch (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t}\n\telse if (typeof define === 'function' && define.amd) {\n\t\treturn function (contextualRequire: any, ...moduleIds: string[]): P<any[]> {\n\t\t\tif (typeof contextualRequire === 'string') {\n\t\t\t\tmoduleIds.unshift(contextualRequire);\n\t\t\t\tcontextualRequire = require;\n\t\t\t}\n\t\t\treturn new Promise(function (resolve) {\n\t\t\t\t// TODO: Error path once https://github.com/dojo/loader/issues/14 is figured out\n\t\t\t\tcontextualRequire(moduleIds, function (...modules: any[]) {\n\t\t\t\t\tresolve(modules);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t}\n\telse {\n\t\treturn function () {\n\t\t\treturn Promise.reject(new Error('Unknown loader'));\n\t\t};\n\t}\n})();\nexport default load;\n"]}